(self.webpackChunk_N_E=self.webpackChunk_N_E||[]).push([[405],{5301:function(e,r,t){(window.__NEXT_P=window.__NEXT_P||[]).push(["/",function(){return t(4186)}])},1159:function(e,r,t){"use strict";t.d(r,{a:function(){return a}});var n=t(1163),s=t(7294),a=function(){var e=(0,s.useState)(null),r=e[0],t=e[1],a=(0,n.useRouter)().push,o=function(){var e=window.localStorage.getItem("CRMProject");try{e=JSON.parse(e),t((function(r){return e}))}catch(r){console.error(r)}};return(0,s.useEffect)((function(){o()}),[]),{userData:r,setUser:function(e){var r=JSON.stringify(e);window.localStorage.setItem("CRMProject",r),o()},removeUser:function(){window.localStorage.removeItem("CRMProject"),o(),a("/")}}}},4186:function(e,r,t){"use strict";t.r(r);var n=t(4051),s=t.n(n),a=t(5893),o=t(1163),c=t(7294),u=t(1159),i=t(2858);function p(e,r,t,n,s,a,o){try{var c=e[a](o),u=c.value}catch(i){return void t(i)}c.done?r(u):Promise.resolve(u).then(n,s)}function l(e){return function(){var r=this,t=arguments;return new Promise((function(n,s){var a=e.apply(r,t);function o(e){p(a,n,s,o,c,"next",e)}function c(e){p(a,n,s,o,c,"throw",e)}o(void 0)}))}}r.default=function(){var e=(0,c.useState)(!1),r=e[0],t=e[1],n=(0,c.useState)(!1),p=n[0],f=n[1],h=(0,c.useState)(!1),d=h[0],v=h[1],m=(0,c.useState)("Log in"),x=m[0],g=m[1],w=(0,u.a)(),j=w.setUser,N=w.removeUser,k=w.userData,b=(0,o.useRouter)().push,y=function(){var e=l(s().mark((function e(n){var a,o;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(n.preventDefault(),!r){e.next=5;break}t(!1),g("Log in"),f(!1),v(!1),e.next=19;break;case 5:return t(!0),g("Authenticating"),"https://crm-api-three.vercel.app/api/auth/login",a={userName:n.target.userName.value,password:n.target.password.value},e.next=11,i.Z.login(a);case 11:if(!(o=e.sent).isError){e.next=16;break}return v(!0),g(o.message),e.abrupt("return");case 16:f(!0),g(o.message),j(o.response);case 19:case"end":return e.stop()}}),e)})));return function(r){return e.apply(this,arguments)}}(),S=function(){var e=l(s().mark((function e(){var r;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:if(!k){e.next=10;break}return e.next=3,i.Z.auth(k.token_refresh);case 3:if(401!==(r=e.sent).status){e.next=7;break}return N(),e.abrupt("return");case 7:j(r.data),t(!0),setTimeout((function(){f(!0),g("Ok"),b("/dashboard")}),500);case 10:case"end":return e.stop()}}),e)})));return function(){return e.apply(this,arguments)}}();return(0,c.useEffect)((function(){S(),console.log("production")}),[k]),(0,a.jsx)("div",{className:"content-login",children:(0,a.jsx)("div",{className:"login-wrapper",children:(0,a.jsxs)("form",{className:"login ".concat(r?"loading":""," ").concat(p?"ok":""," ").concat(d?"error":""),onSubmit:y,children:[(0,a.jsx)("p",{className:"title",children:"Log in"}),(0,a.jsx)("input",{type:"text",name:"userName",placeholder:"User Name",required:!0}),(0,a.jsx)("i",{className:"fa fa-user"}),(0,a.jsx)("input",{type:"password",name:"password",placeholder:"Password",required:!0}),(0,a.jsx)("i",{className:"fa fa-key"}),(0,a.jsx)("a",{href:"#",children:"Forgot your password?"}),(0,a.jsxs)("button",{children:[r&&!1===d&&!1===p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{className:"spinner-border",style:{marginBottom:"70px"},role:"status",children:(0,a.jsx)("span",{className:"sr-only",children:"Loading..."})}),(0,a.jsx)("br",{})]}),r&&!0===d&&!1===p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{marginBottom:"70px",fontSize:"2.5rem"},children:(0,a.jsx)("span",{className:"ion-close-circled"})}),(0,a.jsx)("br",{})]}),r&&!1===d&&!0===p&&(0,a.jsxs)(a.Fragment,{children:[(0,a.jsx)("div",{style:{marginBottom:"70px",fontSize:"2.5rem"},children:(0,a.jsx)("span",{className:"ion-checkmark-round"})}),(0,a.jsx)("br",{})]}),(0,a.jsx)("span",{className:"state",children:x})]})]})})})}},2858:function(e,r,t){"use strict";var n=t(4051),s=t.n(n),a=t(9669),o=t.n(a);function c(e,r,t,n,s,a,o){try{var c=e[a](o),u=c.value}catch(i){return void t(i)}c.done?r(u):Promise.resolve(u).then(n,s)}function u(e){return function(){var r=this,t=arguments;return new Promise((function(n,s){var a=e.apply(r,t);function o(e){c(a,n,s,o,u,"next",e)}function u(e){c(a,n,s,o,u,"throw",e)}o(void 0)}))}}var i="https://crm-api-three.vercel.app/api/",p=function(){var e=u(s().mark((function e(r){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i+"auth",e.prev=2,e.next=5,o().post("https://crm-api-three.vercel.app/api/auth",{},{headers:{refresh:r}});case 5:n=e.sent,t=n,e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t=e.t0.response;case 12:return e.prev=12,e.abrupt("return",t);case 15:case"end":return e.stop()}}),e,null,[[2,9,12,15]])})));return function(r){return e.apply(this,arguments)}}(),l=function(){var e=u(s().mark((function e(r){var t,n;return s().wrap((function(e){for(;;)switch(e.prev=e.next){case 0:return i+"auth/login",e.prev=2,e.next=5,o().post("https://crm-api-three.vercel.app/api/auth/login",r);case 5:n=e.sent.data,t={isError:!1,response:n,message:"success"},e.next=12;break;case 9:e.prev=9,e.t0=e.catch(2),t={isError:!0,response:e.t0.response,message:e.t0.response.data.message};case 12:return e.prev=12,e.abrupt("return",t);case 15:case"end":return e.stop()}}),e,null,[[2,9,12,15]])})));return function(r){return e.apply(this,arguments)}}();r.Z={auth:p,login:l}},1163:function(e,r,t){e.exports=t(880)}},function(e){e.O(0,[669,774,888,179],(function(){return r=5301,e(e.s=r);var r}));var r=e.O();_N_E=r}]);